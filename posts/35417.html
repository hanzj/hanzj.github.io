<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>kubeadm高可用安装k8s-基于containerd - Hanzj</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="hanzj"><meta name="msapplication-TileImage" content="/images/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="hanzj"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="环境准备软件版本 CentOS7.9.2009 containerd 1.6.24 keepalived 1.3.5 haproxy 1.5.18 kubernetes 1.28.2 calico v3.26.1 dashboard 2.7.0"><meta property="og:type" content="blog"><meta property="og:title" content="kubeadm高可用安装k8s-基于containerd"><meta property="og:url" content="https://xchzj.com/posts/35417.html"><meta property="og:site_name" content="Hanzj"><meta property="og:description" content="环境准备软件版本 CentOS7.9.2009 containerd 1.6.24 keepalived 1.3.5 haproxy 1.5.18 kubernetes 1.28.2 calico v3.26.1 dashboard 2.7.0"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://xchzj.com/images/2022/202211241922001.png"><meta property="og:image" content="https://xchzj.com/images/2022/202211241922002.png"><meta property="og:image" content="https://xchzj.com/images/2022/202211241922003.png"><meta property="og:image" content="https://xchzj.com/images/2022/202211241922004.png"><meta property="og:image" content="https://xchzj.com/images/2022/202211241922005.png"><meta property="og:image" content="https://xchzj.com/images/2022/202211241922006.png"><meta property="article:published_time" content="2023-10-05T16:00:00.000Z"><meta property="article:modified_time" content="2023-10-06T04:14:39.102Z"><meta property="article:author" content="hanzj"><meta property="article:tag" content="k8s"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://xchzj.com/images/2022/202211241922001.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://xchzj.com/posts/35417.html"},"headline":"kubeadm高可用安装k8s-基于containerd","image":["https://xchzj.com/images/2022/202211241922001.png","https://xchzj.com/images/2022/202211241922002.png","https://xchzj.com/images/2022/202211241922003.png","https://xchzj.com/images/2022/202211241922004.png","https://xchzj.com/images/2022/202211241922005.png","https://xchzj.com/images/2022/202211241922006.png"],"datePublished":"2023-10-05T16:00:00.000Z","dateModified":"2023-10-06T04:14:39.102Z","author":{"@type":"Person","name":"hanzj"},"publisher":{"@type":"Organization","name":"Hanzj","logo":{"@type":"ImageObject","url":"https://xchzj.com/images/favicon.png"}},"description":"环境准备软件版本 CentOS7.9.2009 containerd 1.6.24 keepalived 1.3.5 haproxy 1.5.18 kubernetes 1.28.2 calico v3.26.1 dashboard 2.7.0"}</script><link rel="canonical" href="https://xchzj.com/posts/35417.html"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/favicon.png" alt="Hanzj" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-10-05T16:00:00.000Z" title="2023/10/6 00:00:00">2023-10-06</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/cloud/">云计算</a></span><span class="level-item">14 分钟读完 (大约2148个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">kubeadm高可用安装k8s-基于containerd</h1><div class="content"><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><h2 id="软件版本"><a href="#软件版本" class="headerlink" title="软件版本"></a>软件版本</h2><ul>
<li>CentOS7.9.2009</li>
<li>containerd 1.6.24</li>
<li>keepalived 1.3.5</li>
<li>haproxy 1.5.18</li>
<li>kubernetes 1.28.2</li>
<li>calico v3.26.1</li>
<li>dashboard 2.7.0<span id="more"></span></li>
</ul>
<h2 id="准备服务器"><a href="#准备服务器" class="headerlink" title="准备服务器"></a>准备服务器</h2><p>这里准备了四台CentOS虚拟机，每台2核cpu和2G内，所有操作都是使用root账户。虚拟机具体信息如下表：</p>
<table>
<thead>
<tr>
<th>IP地址</th>
<th>Hostname</th>
<th>节点角色</th>
</tr>
</thead>
<tbody><tr>
<td>192.168.146.130</td>
<td>node130</td>
<td>control plane</td>
</tr>
<tr>
<td>192.168.146.131</td>
<td>node131</td>
<td>control plane</td>
</tr>
<tr>
<td>192.168.146.132</td>
<td>node132</td>
<td>worker nodes</td>
</tr>
<tr>
<td>192.168.146.133</td>
<td>node133</td>
<td>worker nodes</td>
</tr>
<tr>
<td>192.168.146.200</td>
<td></td>
<td>VIP</td>
</tr>
</tbody></table>
<blockquote>
<p>生产机集群至少需要三台</p>
</blockquote>
<h2 id="常用软件安装"><a href="#常用软件安装" class="headerlink" title="常用软件安装"></a>常用软件安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget vim  net-tools</span><br></pre></td></tr></table></figure>

<h2 id="关闭、禁用防火墙"><a href="#关闭、禁用防火墙" class="headerlink" title="关闭、禁用防火墙"></a>关闭、禁用防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line">systemctl stop    firewalld</span><br><span class="line">systemctl status  firewalld</span><br></pre></td></tr></table></figure>

<h2 id="禁用SELinux"><a href="#禁用SELinux" class="headerlink" title="禁用SELinux"></a>禁用SELinux</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0 &amp;&amp; sed -i  <span class="string">&#x27;s/SELINUX=enforcing/SELINUX=disabled/g&#x27;</span> /etc/selinux/config</span><br></pre></td></tr></table></figure>

<h2 id="禁用swap"><a href="#禁用swap" class="headerlink" title="禁用swap"></a>禁用swap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a &amp;&amp; sed -i <span class="string">&#x27;/ swap / s/^\\(.*\\)$/#\\1/g&#x27;</span> /etc/fstab</span><br></pre></td></tr></table></figure>

<h2 id="修改linux内核参数"><a href="#修改linux内核参数" class="headerlink" title="修改linux内核参数"></a>修改linux内核参数</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">临时新增</span></span><br><span class="line">modprobe br_netfilter</span><br><span class="line">modprobe overlay</span><br><span class="line">lsmod |grep br_netfilter</span><br><span class="line">lsmod |grep overlay</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">永久新增</span></span><br><span class="line">cat &gt; /etc/sysconfig/modules/br_netfilter.modules &lt;&lt; EOF</span><br><span class="line">modprobe br_netfilter</span><br><span class="line">modprobe overlay</span><br><span class="line">EOF</span><br><span class="line">chmod +x /etc/sysconfig/modules/br_netfilter.modules</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">写入配置文件</span></span><br><span class="line">cat &lt;&lt;EOF &gt; /etc/sysctl.d/k8s.conf</span><br><span class="line">vm.swappiness=0</span><br><span class="line">net.ipv4.ip_forward = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">生效配置文件</span></span><br><span class="line">sysctl -p /etc/sysctl.d/k8s.conf</span><br></pre></td></tr></table></figure>

<h2 id="配置ipvs"><a href="#配置ipvs" class="headerlink" title="配置ipvs"></a>配置ipvs</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">yum install ipset ipvsadm  -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加需要加载的模块</span></span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string">modprobe -- ip_vs</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_rr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_wrr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_sh</span></span><br><span class="line"><span class="string">modprobe -- nf_conntrack</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 授权、运行、检查是否加载</span></span><br><span class="line"><span class="built_in">chmod</span> +x /etc/sysconfig/modules/ipvs.modules &amp;&amp; bash /etc/sysconfig/modules/ipvs.modules &amp;&amp; lsmod | grep -e ip_vs -e nf_conntrack</span><br></pre></td></tr></table></figure>

<h1 id="安装容器环境"><a href="#安装容器环境" class="headerlink" title="安装容器环境"></a>安装容器环境</h1><h3 id="安装containerd"><a href="#安装containerd" class="headerlink" title="安装containerd"></a>安装containerd</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tee</span> &gt; /etc/yum.repos.d/docker-ce.repo &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[docker-ce-stable]</span></span><br><span class="line"><span class="string">name=Docker CE Stable - $basearch</span></span><br><span class="line"><span class="string">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/\$releasever/\$basearch/stable</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">gpgcheck=1</span></span><br><span class="line"><span class="string">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">yum makecache</span><br><span class="line"></span><br><span class="line">yum install -y containerd.io</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成配置文件</span></span><br><span class="line">containerd config default &gt; /etc/containerd/config.toml</span><br><span class="line"><span class="comment"># SystemdCgroup = false 改为 SystemdCgroup = true</span></span><br><span class="line">sed -i  <span class="string">&#x27;s/SystemdCgroup = false/SystemdCgroup = true/g&#x27;</span> /etc/containerd/config.toml</span><br><span class="line"><span class="comment"># sandbox_image = &quot;k8s.gcr.io/pause:3.6&quot; 改为：</span></span><br><span class="line"><span class="comment"># sandbox_image = &quot;registry.aliyuncs.com/google_containers/pause:3.9&quot;</span></span><br><span class="line">sed -i  <span class="string">&#x27;s#registry.k8s.io/pause:3.6#registry.aliyuncs.com/google_containers/pause:3.9#g&#x27;</span> /etc/containerd/config.toml</span><br><span class="line"></span><br><span class="line">systemctl <span class="built_in">enable</span> containerd</span><br><span class="line">systemctl start  containerd</span><br><span class="line">containerd --version</span><br><span class="line">ctr images <span class="built_in">ls</span> </span><br></pre></td></tr></table></figure>

<h1 id="高可用环境搭建"><a href="#高可用环境搭建" class="headerlink" title="高可用环境搭建"></a>高可用环境搭建</h1><h2 id="安装haproxy"><a href="#安装haproxy" class="headerlink" title="安装haproxy"></a>安装haproxy</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># node130  和  node131</span></span><br><span class="line">yum install -y haproxy</span><br><span class="line"><span class="built_in">tee</span>  /etc/haproxy/haproxy.cfg &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">global</span></span><br><span class="line"><span class="string">    log         127.0.0.1 local2</span></span><br><span class="line"><span class="string">    chroot      /var/lib/haproxy</span></span><br><span class="line"><span class="string">    pidfile     /var/run/haproxy.pid</span></span><br><span class="line"><span class="string">    maxconn     4000</span></span><br><span class="line"><span class="string">    user        haproxy</span></span><br><span class="line"><span class="string">    group       haproxy</span></span><br><span class="line"><span class="string">    daemon</span></span><br><span class="line"><span class="string">    stats socket /var/lib/haproxy/stats</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#---------------------------------------------------------------------</span></span><br><span class="line"><span class="string"># common defaults that all the &#x27;listen&#x27; and &#x27;backend&#x27; sections will</span></span><br><span class="line"><span class="string"># use if not designated in their block</span></span><br><span class="line"><span class="string">#---------------------------------------------------------------------</span></span><br><span class="line"><span class="string">defaults</span></span><br><span class="line"><span class="string">    mode                    http</span></span><br><span class="line"><span class="string">    log                     global</span></span><br><span class="line"><span class="string">    option                  httplog</span></span><br><span class="line"><span class="string">    option                  dontlognull</span></span><br><span class="line"><span class="string">    option http-server-close</span></span><br><span class="line"><span class="string">    option forwardfor       except 127.0.0.0/8</span></span><br><span class="line"><span class="string">    option                  redispatch</span></span><br><span class="line"><span class="string">    retries                 3</span></span><br><span class="line"><span class="string">    timeout http-request    10s</span></span><br><span class="line"><span class="string">    timeout queue           1m</span></span><br><span class="line"><span class="string">    timeout connect         10s</span></span><br><span class="line"><span class="string">    timeout client          1m</span></span><br><span class="line"><span class="string">    timeout server          1m</span></span><br><span class="line"><span class="string">    timeout http-keep-alive 10s</span></span><br><span class="line"><span class="string">    timeout check           10s</span></span><br><span class="line"><span class="string">    maxconn                 3000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#---------------------------------------------------------------------</span></span><br><span class="line"><span class="string"># apiserver frontend which proxys to the masters</span></span><br><span class="line"><span class="string">#---------------------------------------------------------------------</span></span><br><span class="line"><span class="string">frontend k8s-apiserver</span></span><br><span class="line"><span class="string">    bind *:9443</span></span><br><span class="line"><span class="string">    mode tcp</span></span><br><span class="line"><span class="string">    option tcplog</span></span><br><span class="line"><span class="string">    default_backend k8s-apiserver</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#---------------------------------------------------------------------</span></span><br><span class="line"><span class="string"># round robin balancing for apiserver</span></span><br><span class="line"><span class="string">#---------------------------------------------------------------------</span></span><br><span class="line"><span class="string">backend k8s-apiserver</span></span><br><span class="line"><span class="string">    mode tcp</span></span><br><span class="line"><span class="string">    option tcplog</span></span><br><span class="line"><span class="string">    option tcpcheck</span></span><br><span class="line"><span class="string">    balance     roundrobin</span></span><br><span class="line"><span class="string">    server node131 192.168.146.131:6443 check</span></span><br><span class="line"><span class="string">    server node130 192.168.146.130:6443 check</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">systemctl start  haproxy</span><br><span class="line">systemctl <span class="built_in">enable</span> haproxy</span><br></pre></td></tr></table></figure>

<h2 id="安装keeplived"><a href="#安装keeplived" class="headerlink" title="安装keeplived"></a>安装keeplived</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># node130 和 node131节点</span></span><br><span class="line">yum -y install keepalived</span><br></pre></td></tr></table></figure>

<p>node130节点配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tee</span> /etc/keepalived/keepalived.conf &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">! Configuration File for keepalived</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">global_defs &#123;</span></span><br><span class="line"><span class="string">   router_id LVS_DEVEL</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vrrp_script chk_haproxy &#123;</span></span><br><span class="line"><span class="string">    script &quot;/bin/bash -c &#x27;if [[ \$(netstat -nlp | grep 9443) ]]; then exit 0; else exit 1; fi&#x27;&quot;  # haproxy 检测</span></span><br><span class="line"><span class="string">    interval 2  # 每2秒执行一次检测</span></span><br><span class="line"><span class="string">    weight 11 # 权重变化</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">vrrp_instance VI_1 &#123;</span></span><br><span class="line"><span class="string">    state MASTER</span></span><br><span class="line"><span class="string">    interface ens33</span></span><br><span class="line"><span class="string">    virtual_router_id 51</span></span><br><span class="line"><span class="string">    priority 100</span></span><br><span class="line"><span class="string">    advert_int 1</span></span><br><span class="line"><span class="string">    authentication &#123;</span></span><br><span class="line"><span class="string">        auth_type PASS</span></span><br><span class="line"><span class="string">        auth_pass 1111</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    virtual_ipaddress &#123;</span></span><br><span class="line"><span class="string">        192.168.146.200</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">		track_script &#123;</span></span><br><span class="line"><span class="string">	      chk_haproxy</span></span><br><span class="line"><span class="string">	  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>node131节点配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tee</span> /etc/keepalived/keepalived.conf &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">! Configuration File for keepalived</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">global_defs &#123;</span></span><br><span class="line"><span class="string">   router_id LVS_DEVEL</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">vrrp_script chk_haproxy &#123;</span></span><br><span class="line"><span class="string">    script &quot;/bin/bash -c &#x27;if [[ $(netstat -nlp | grep 9443) ]]; then exit 0; else exit 1; fi&#x27;&quot;  # haproxy 检测</span></span><br><span class="line"><span class="string">    interval 2  # 每2秒执行一次检测</span></span><br><span class="line"><span class="string">    weight 11 # 权重变化</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">vrrp_instance VI_1 &#123;</span></span><br><span class="line"><span class="string">    state BACKUP</span></span><br><span class="line"><span class="string">    interface ens33</span></span><br><span class="line"><span class="string">    virtual_router_id 51</span></span><br><span class="line"><span class="string">    priority 90</span></span><br><span class="line"><span class="string">    advert_int 1</span></span><br><span class="line"><span class="string">    authentication &#123;</span></span><br><span class="line"><span class="string">        auth_type PASS</span></span><br><span class="line"><span class="string">        auth_pass 1111</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    virtual_ipaddress &#123;</span></span><br><span class="line"><span class="string">        192.168.146.200</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">		track_script &#123;</span></span><br><span class="line"><span class="string">	      chk_haproxy</span></span><br><span class="line"><span class="string">	  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p>启动keepalived</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start  keepalived</span><br><span class="line">systemctl <span class="built_in">enable</span> keepalived</span><br><span class="line">ip a</span><br><span class="line"><span class="comment"># 可以在node130上看到虚拟ip 192.168.146.200</span></span><br></pre></td></tr></table></figure>

<h1 id="安装-kubernetes"><a href="#安装-kubernetes" class="headerlink" title="安装 kubernetes"></a>安装 kubernetes</h1><h2 id="设置kubernetes源"><a href="#设置kubernetes源" class="headerlink" title="设置kubernetes源"></a>设置kubernetes源</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">所有节点配置</span></span><br><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">阿里云gpgcheck不过，关闭验证</span></span><br><span class="line">repo_gpgcheck=0</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg  https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">yum clean all</span><br></pre></td></tr></table></figure>

<h2 id="安装kubeadm"><a href="#安装kubeadm" class="headerlink" title="安装kubeadm"></a>安装kubeadm</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">所有节点 安装kubelet kubeadm kubectl;kubeadm依赖kubelet和kubectl</span></span><br><span class="line">yum install -y kubelet kubeadm kubectl</span><br><span class="line">kubectl version</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改内容如下</span></span><br><span class="line">echo KUBELET_EXTRA_ARGS=\&quot;--cgroup-driver=systemd\&quot; &gt;  /etc/sysconfig/kubelet</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl enable kubelet</span><br><span class="line">systemctl restart kubelet</span><br></pre></td></tr></table></figure>

<h2 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看k8s依赖的镜像，可以在node130上逐个手动下载</span></span><br><span class="line">kubeadm config images list</span><br><span class="line">kubeadm config images pull --image-repository registry.aliyuncs.com/google_containers --cri-socket=unix:///var/run/cri-dockerd.sock</span><br></pre></td></tr></table></figure>

<h2 id="master初始化"><a href="#master初始化" class="headerlink" title="master初始化"></a>master初始化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># node130上执行  初始化Master</span></span><br><span class="line">kubeadm init --kubernetes-version=1.28.2 \</span><br><span class="line">--apiserver-advertise-address=192.168.146.200 \</span><br><span class="line">--control-plane-endpoint <span class="string">&quot;192.168.146.200:6443&quot;</span> \</span><br><span class="line">--image-repository registry.aliyuncs.com/google_containers \</span><br><span class="line">--pod-network-cidr=10.244.0.0/16  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># kubeadm reset &amp;&amp; rm -rf $HOME/.kube/config</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#################### 安装成功的提示，以下为注释  ####################</span></span><br><span class="line">Your Kubernetes control-plane has initialized successfully!</span><br><span class="line"></span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">  sudo <span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">  sudo <span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br><span class="line">Alternatively, <span class="keyword">if</span> you are the root user, you can run:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf</span><br><span class="line"></span><br><span class="line">You should now deploy a pod network to the cluster.</span><br><span class="line">Run <span class="string">&quot;kubectl apply -f [podnetwork].yaml&quot;</span> with one of the options listed at:</span><br><span class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br><span class="line"></span><br><span class="line">You can now <span class="built_in">join</span> any number of control-plane nodes by copying certificate authorities</span><br><span class="line">and service account keys on each node and <span class="keyword">then</span> running the following as root:</span><br><span class="line"></span><br><span class="line">  kubeadm <span class="built_in">join</span> 192.168.146.200:6443 --token ipjohl.9hhmudgcz897ouzd \</span><br><span class="line">	--discovery-token-ca-cert-hash sha256:98df6afbca74ccf537825a4186904dc6cd8574373721e638f8c21ca1e52ead04 \</span><br><span class="line">	--control-plane </span><br><span class="line"></span><br><span class="line">Then you can <span class="built_in">join</span> any number of worker nodes by running the following on each as root:</span><br><span class="line"></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.146.200:6443 --token ipjohl.9hhmudgcz897ouzd \</span><br><span class="line">	--discovery-token-ca-cert-hash sha256:98df6afbca74ccf537825a4186904dc6cd8574373721e638f8c21ca1e52ead04</span><br><span class="line"><span class="comment">#################### 至此 都是注释 ####################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># node131上执行 创建证书目录,安装时没有提示，确实必须的</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /etc/kubernetes/pki/etcd</span><br><span class="line">scp root@node130:/etc/kubernetes/admin.conf /etc/kubernetes/</span><br><span class="line">scp root@node130:/etc/kubernetes/pki/&#123;ca.crt,ca.key,sa.key,sa.pub,front-proxy-ca.crt,front-proxy-ca.key&#125; /etc/kubernetes/pki/</span><br><span class="line">scp root@node130:/etc/kubernetes/pki/etcd/&#123;ca.crt,ca.key&#125;  /etc/kubernetes/pki/etcd/</span><br><span class="line"></span><br><span class="line"><span class="comment"># node131  master加入集群</span></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.146.200:6443 --token ipjohl.9hhmudgcz897ouzd \</span><br><span class="line">	--discovery-token-ca-cert-hash sha256:98df6afbca74ccf537825a4186904dc6cd8574373721e638f8c21ca1e52ead04 \</span><br><span class="line">	--control-plane </span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果是root用户，node130、node131上执行</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export KUBECONFIG=/etc/kubernetes/admin.conf&quot;</span> &gt;&gt; ~/.bash_profile </span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果是非root用户，node130、node131上执行</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">sudo <span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">sudo <span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br></pre></td></tr></table></figure>

<h2 id="worker节点加入"><a href="#worker节点加入" class="headerlink" title="worker节点加入"></a>worker节点加入</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">node132和node133 work 加入集群</span></span><br><span class="line">kubeadm join 192.168.146.200:6443 --token ipjohl.9hhmudgcz897ouzd \</span><br><span class="line">	--discovery-token-ca-cert-hash sha256:98df6afbca74ccf537825a4186904dc6cd8574373721e638f8c21ca1e52ead04 </span><br><span class="line">	--cri-socket=unix:///var/run/cri-dockerd.sock</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">节点查看</span></span><br><span class="line">kubectl get nodes # node节点需要较长时间才会Ready</span><br><span class="line">kubectl get po -o wide -n kube-system</span><br></pre></td></tr></table></figure>

<h2 id="部署网络"><a href="#部署网络" class="headerlink" title="部署网络"></a>部署网络</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在node130上安装flannel网络</span></span><br><span class="line">kubectl create -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/tigera-operator.yaml</span><br><span class="line"></span><br><span class="line">wget https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/custom-resources.yaml</span><br><span class="line">vim  custom-resources.yaml</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">########################### 文件内容如下</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This section includes base Calico installation configuration.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For more information, see: https://projectcalico.docs.tigera.io/master/reference/installation/api<span class="comment">#operator.tigera.io/v1.Installation</span></span></span><br><span class="line">apiVersion: operator.tigera.io/v1</span><br><span class="line">kind: Installation</span><br><span class="line">metadata:</span><br><span class="line">  name: default</span><br><span class="line">spec:</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">Configures Calico networking.</span></span><br><span class="line">  calicoNetwork:</span><br><span class="line">    # Note: The ipPools section cannot be modified post-install.</span><br><span class="line">    ipPools:</span><br><span class="line">    - blockSize: 26</span><br><span class="line">      cidr: 10.244.0.0/16 # 修改此行内容</span><br><span class="line">      encapsulation: VXLANCrossSubnet</span><br><span class="line">      natOutgoing: Enabled</span><br><span class="line">      nodeSelector: all()</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This section configures the Calico API server.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For more information, see: https://projectcalico.docs.tigera.io/master/reference/installation/api<span class="comment">#operator.tigera.io/v1.APIServer</span></span></span><br><span class="line">apiVersion: operator.tigera.io/v1</span><br><span class="line">kind: APIServer</span><br><span class="line">metadata:</span><br><span class="line">  name: default</span><br><span class="line">spec: &#123;&#125;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">########################### end ############################</span></span></span><br><span class="line"></span><br><span class="line">kubectl create -f  custom-resources.yaml</span><br><span class="line"></span><br><span class="line">kubectl get pods -n calico-system</span><br></pre></td></tr></table></figure>

<h2 id="查看集群状态"><a href="#查看集群状态" class="headerlink" title="查看集群状态"></a>查看集群状态</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -n calico-system</span><br><span class="line">kubectl get pods -n kube-system</span><br><span class="line">kubectl get node -o wide </span><br></pre></td></tr></table></figure>

<h1 id="可视化界面dashboard安装"><a href="#可视化界面dashboard安装" class="headerlink" title="可视化界面dashboard安装"></a>可视化界面dashboard安装</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml</span><br><span class="line">sed -i &quot;s/kubernetesui/registry.aliyuncs.com\\/google_containers/g&quot; recommended.yaml</span><br><span class="line">sed -i &quot;/targetPort: 8443/a\\ \\ \\ \\ \\ \\ nodePort: 30433\\n\\ \\ type: NodePort&quot; recommended.yaml</span><br><span class="line"></span><br><span class="line">kubectl apply -f recommended.yaml</span><br><span class="line">kubectl get all -n kubernetes-dashboard</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">新增管理员账号</span></span><br><span class="line">cat &gt;&gt; dashboard-admin.yaml &lt;&lt; EOF</span><br><span class="line">---</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">------------------- dashboard-admin ------------------- <span class="comment">#</span></span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: dashboard-admin</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: dashboard-admin</span><br><span class="line">subjects:</span><br><span class="line">- kind: ServiceAccount</span><br><span class="line">  name: dashboard-admin</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: cluster-admin</span><br><span class="line">EOF</span><br><span class="line"> </span><br><span class="line">kubectl apply -f dashboard-admin.yaml</span><br><span class="line"></span><br><span class="line">kubectl -n kubernetes-dashboard create token dashboard-admin</span><br><span class="line"></span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6Ijh3ZW9IMVdBMGFYaGc4WmRjMFVid3BIYzhSVUFvLTRZY3ZNYkpRd1VrQ2sifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNjk2NTY2MjA0LCJpYXQiOjE2OTY1NjI2MDQsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsInNlcnZpY2VhY2NvdW50Ijp7Im5hbWUiOiJkYXNoYm9hcmQtYWRtaW4iLCJ1aWQiOiI3MDYwYWMwOC1mZGU3LTQzZTYtODI0My05ZGM0N2I2MTIwNzMifX0sIm5iZiI6MTY5NjU2MjYwNCwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmVybmV0ZXMtZGFzaGJvYXJkOmRhc2hib2FyZC1hZG1pbiJ9.HwQB4-FfeGdI9sduT5HgDzm1LIcywlBc4fO2LWhXsiumb9HkXuQyRu5pFS32KR7XFn8IL9wb2fuFGLIJqnGIfCQhDaZ0cDfTRothE4g4V_BN6ZIwXXMs5UTPNUOBBPW_ZsGXcvnfzhLXZtuClwgrrqJYtA_cY4JLuHol2Y4T-dnG75el6EXt5LUJG1RwstMIr9IFG6lLPT3t3Dxq4lqjvFNzzp9hcmSiINMiOEMo7Qk52J9gbWs-_JBJulZiMy8RcHGIpDy2DusgQlRp73bfONFUnChXE8PIhEeItbVmfLUDWJ9s0bIYGinxpd2AL1p8GrrlNlGtGm8pHqXcv3bKNA</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>访问<code>https://192.168.146.200:30433</code></p>
<p><img src="https://xchzj.com/images/2022/202211241922001.png"></p>
<h1 id="可视化界面kuboard安装"><a href="#可视化界面kuboard安装" class="headerlink" title="可视化界面kuboard安装"></a>可视化界面kuboard安装</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 node131节点上执行</span></span><br><span class="line">docker run -d \</span><br><span class="line">  --restart=unless-stopped \</span><br><span class="line">  --name=kuboard \</span><br><span class="line">  -p 80:80/tcp \</span><br><span class="line">  -p 10081:10081/tcp \</span><br><span class="line">  -e KUBOARD_ENDPOINT=<span class="string">&quot;http://192.168.146.131:80&quot;</span> \</span><br><span class="line">  -e KUBOARD_AGENT_SERVER_TCP_PORT=<span class="string">&quot;10081&quot;</span> \</span><br><span class="line">  -v /root/kuboard-data:/data \</span><br><span class="line">  eipwork/kuboard:v3</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 以下通过k8s安装失败，可以另外找一台机器通过docker部署</span></span><br><span class="line">  kubectl apply -f https://addons.kuboard.cn/kuboard/kuboard-v3.yaml</span><br><span class="line">  <span class="comment"># 等待 kuboard 名称空间中所有的 Pod 就绪</span></span><br><span class="line">  watch kubectl get pods -n kuboard</span><br></pre></td></tr></table></figure>

<p>通过浏览器访问 <a target="_blank" rel="noopener" href="http://192.168.146.131/">http://192.168.146.131</a></p>
<p><img src="https://xchzj.com/images/2022/202211241922002.png"></p>
<p>输入默认默认用户名：admin   密码：Kuborad123 进行登录</p>
<p><img src="https://xchzj.com/images/2022/202211241922003.png"></p>
<p>点击添加集群，使用token方式进行认证</p>
<p><img src="https://xchzj.com/images/2022/202211241922004.png"></p>
<p>如下图说明集群导入成功，点击 <strong>kuboard-admin</strong> 后进入<strong>集群概要</strong><br><img src="https://xchzj.com/images/2022/202211241922005.png"></p>
<h1 id="安装mysql进行测试"><a href="#安装mysql进行测试" class="headerlink" title="安装mysql进行测试"></a>安装mysql进行测试</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建命名空间</span></span><br><span class="line">kubectl create ns database</span><br><span class="line"></span><br><span class="line"><span class="built_in">tee</span> mysql_deploy.yaml &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">apiVersion: apps/v1                             # apiserver的版本</span></span><br><span class="line"><span class="string">kind: Deployment                                # 副本控制器deployment，管理pod和RS</span></span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="string">  name: mysql                                   # deployment的名称，全局唯一</span></span><br><span class="line"><span class="string">  namespace: database                           # deployment所在的命名空间</span></span><br><span class="line"><span class="string">  labels:</span></span><br><span class="line"><span class="string">    app: mysql</span></span><br><span class="line"><span class="string">spec:</span></span><br><span class="line"><span class="string">  replicas: 1                                   # Pod副本期待数量</span></span><br><span class="line"><span class="string">  selector:</span></span><br><span class="line"><span class="string">    matchLabels:                                # 定义RS的标签</span></span><br><span class="line"><span class="string">      app: mysql                                # 符合目标的Pod拥有此标签</span></span><br><span class="line"><span class="string">  strategy:                                     # 定义升级的策略</span></span><br><span class="line"><span class="string">    type: RollingUpdate                         # 滚动升级，逐步替换的策略</span></span><br><span class="line"><span class="string">  template:                                     # 根据此模板创建Pod的副本（实例）</span></span><br><span class="line"><span class="string">    metadata:</span></span><br><span class="line"><span class="string">      labels:</span></span><br><span class="line"><span class="string">        app: mysql                              # Pod副本的标签，对应RS的Selector</span></span><br><span class="line"><span class="string">    spec:</span></span><br><span class="line"><span class="string">      # nodeName: k8s-worker01                    # 指定pod运行在的node</span></span><br><span class="line"><span class="string">      containers:                               # Pod里容器的定义部分</span></span><br><span class="line"><span class="string">        - name: mysql                           # 容器的名称</span></span><br><span class="line"><span class="string">          image: mysql:8.0                     # 容器对应的docker镜像</span></span><br><span class="line"><span class="string">          volumeMounts:                         # 容器内挂载点的定义部分</span></span><br><span class="line"><span class="string">            - name: time-zone                   # 容器内挂载点名称</span></span><br><span class="line"><span class="string">              mountPath: /etc/localtime         # 容器内挂载点路径，可以是文件或目录</span></span><br><span class="line"><span class="string">            - name: mysql-data</span></span><br><span class="line"><span class="string">              mountPath: /var/lib/mysql         # 容器内mysql的数据目录</span></span><br><span class="line"><span class="string">            - name: mysql-logs</span></span><br><span class="line"><span class="string">              mountPath: /var/log/mysql         # 容器内mysql的日志目录</span></span><br><span class="line"><span class="string">          ports:</span></span><br><span class="line"><span class="string">            - containerPort: 3306               # 容器暴露的端口号</span></span><br><span class="line"><span class="string">          env:                                  # 写入到容器内的环境容量</span></span><br><span class="line"><span class="string">            - name: MYSQL_ROOT_PASSWORD         # 定义了一个mysql的root密码的变量</span></span><br><span class="line"><span class="string">              value: &quot;123456&quot;</span></span><br><span class="line"><span class="string">      volumes:                                  # 本地需要挂载到容器里的数据卷定义部分</span></span><br><span class="line"><span class="string">        - name: time-zone                       # 数据卷名称，需要与容器内挂载点名称一致</span></span><br><span class="line"><span class="string">          hostPath:</span></span><br><span class="line"><span class="string">            path: /etc/localtime                # 挂载到容器里的路径，将localtime文件挂载到容器里，可让容器使用本地的时区</span></span><br><span class="line"><span class="string">        - name: mysql-data</span></span><br><span class="line"><span class="string">          hostPath:</span></span><br><span class="line"><span class="string">            path: /data/mysql/data              # 本地存放mysql数据的目录</span></span><br><span class="line"><span class="string">        - name: mysql-logs</span></span><br><span class="line"><span class="string">          hostPath:</span></span><br><span class="line"><span class="string">            path: /data/mysql/logs              # 本地存入mysql日志的目录</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">kubectl create -f mysql_deploy.yaml</span><br><span class="line"><span class="comment"># 查看容器状态</span></span><br><span class="line">kubectl -n database get pods </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看容器具体状态</span></span><br><span class="line">kubectl -n database describe pod</span><br><span class="line"></span><br><span class="line"><span class="comment"># 命令行访问mysql</span></span><br><span class="line">kubectl -n database  <span class="built_in">exec</span> -it mysql-5ccddd6b74-l5652 -- mysql -uroot -p</span><br></pre></td></tr></table></figure>

<p>通过kuboard登录<br><img src="https://xchzj.com/images/2022/202211241922006.png"></p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/k8s/">k8s</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/12027.html"><span class="level-item">Flink安装</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/gravatar.jpg" alt="hanzj"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">hanzj</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>郑州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">3</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Gmail" href="mailto:zhenjie.han@gmail.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#环境准备"><span class="level-left"><span class="level-item">1</span><span class="level-item">环境准备</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#软件版本"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">软件版本</span></span></a></li><li><a class="level is-mobile" href="#准备服务器"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">准备服务器</span></span></a></li><li><a class="level is-mobile" href="#常用软件安装"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">常用软件安装</span></span></a></li><li><a class="level is-mobile" href="#关闭、禁用防火墙"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">关闭、禁用防火墙</span></span></a></li><li><a class="level is-mobile" href="#禁用SELinux"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">禁用SELinux</span></span></a></li><li><a class="level is-mobile" href="#禁用swap"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">禁用swap</span></span></a></li><li><a class="level is-mobile" href="#修改linux内核参数"><span class="level-left"><span class="level-item">1.7</span><span class="level-item">修改linux内核参数</span></span></a></li><li><a class="level is-mobile" href="#配置ipvs"><span class="level-left"><span class="level-item">1.8</span><span class="level-item">配置ipvs</span></span></a></li></ul></li><li><a class="level is-mobile" href="#安装容器环境"><span class="level-left"><span class="level-item">2</span><span class="level-item">安装容器环境</span></span></a><ul class="menu-list"><ul class="menu-list"><li><a class="level is-mobile" href="#安装containerd"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">安装containerd</span></span></a></li></ul></ul></li><li><a class="level is-mobile" href="#高可用环境搭建"><span class="level-left"><span class="level-item">3</span><span class="level-item">高可用环境搭建</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#安装haproxy"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">安装haproxy</span></span></a></li><li><a class="level is-mobile" href="#安装keeplived"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">安装keeplived</span></span></a></li></ul></li><li><a class="level is-mobile" href="#安装-kubernetes"><span class="level-left"><span class="level-item">4</span><span class="level-item">安装 kubernetes</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#设置kubernetes源"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">设置kubernetes源</span></span></a></li><li><a class="level is-mobile" href="#安装kubeadm"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">安装kubeadm</span></span></a></li><li><a class="level is-mobile" href="#下载镜像"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">下载镜像</span></span></a></li><li><a class="level is-mobile" href="#master初始化"><span class="level-left"><span class="level-item">4.4</span><span class="level-item">master初始化</span></span></a></li><li><a class="level is-mobile" href="#worker节点加入"><span class="level-left"><span class="level-item">4.5</span><span class="level-item">worker节点加入</span></span></a></li><li><a class="level is-mobile" href="#部署网络"><span class="level-left"><span class="level-item">4.6</span><span class="level-item">部署网络</span></span></a></li><li><a class="level is-mobile" href="#查看集群状态"><span class="level-left"><span class="level-item">4.7</span><span class="level-item">查看集群状态</span></span></a></li></ul></li><li><a class="level is-mobile" href="#可视化界面dashboard安装"><span class="level-left"><span class="level-item">5</span><span class="level-item">可视化界面dashboard安装</span></span></a></li><li><a class="level is-mobile" href="#可视化界面kuboard安装"><span class="level-left"><span class="level-item">6</span><span class="level-item">可视化界面kuboard安装</span></span></a></li><li><a class="level is-mobile" href="#安装mysql进行测试"><span class="level-left"><span class="level-item">7</span><span class="level-item">安装mysql进行测试</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/cloud/"><span class="level-start"><span class="level-item">云计算</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/bigdata/"><span class="level-start"><span class="level-item">大数据</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-05T16:00:00.000Z">2023-10-06</time></p><p class="title"><a href="/posts/35417.html">kubeadm高可用安装k8s-基于containerd</a></p><p class="categories"><a href="/categories/cloud/">云计算</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-11-28T12:22:36.000Z">2022-11-28</time></p><p class="title"><a href="/posts/12027.html">Flink安装</a></p><p class="categories"><a href="/categories/bigdata/">大数据</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-11-24T14:05:36.000Z">2022-11-24</time></p><p class="title"><a href="/posts/23102.html">kubeadm高可用安装k8s-基于docker</a></p><p class="categories"><a href="/categories/cloud/">云计算</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-11-23T14:05:36.000Z">2022-11-23</time></p><p class="title"><a href="/posts/16107.html">Docker常用软件安装</a></p><p class="categories"><a href="/categories/cloud/">云计算</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">十一月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flink/"><span class="tag">flink</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/k8s/"><span class="tag">k8s</span><span class="tag">2</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer" style="padding:10px 0;"><div class="container"><div class="level"><div class="level-start"><p class="is-size-7"><span>&copy; 2025 hanzj</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>